<html>
    <head>
        <style>
            * {
                font-family: "Comic Sans MS", 標楷體;
            }
            ::-webkit-scrollbar-track{
                -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
                border-radius: 10px;
                background-color: #333333;
            }
            ::-webkit-scrollbar-thumb {
                cursor: default;
                background-color: #a1a1a1;
                border-radius: 10px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background-color: #888888;
            }
            ::-webkit-scrollbar {
                width: 10px;
                height: 10px;
            }
            body {
                background-color: #181818;
                color:#e8e8e8;
            }
            #cvs{
                height: 548.15px;
            }
            .di{
                display: flex;
                justify-content: center;
            }
        </style>
    </head>
    <body>
        <div class="di">
            <canvas id="cvs" width="2000" height="3000"></canvas>
        </div>
        <script>
            var cvs=document.querySelector("#cvs");
            var ctx=cvs.getContext("2d");
            var sht=5,peo=[],ttl=0,ttl1=0,peo2=[1,3,5],br=100,br1=10,ck=1,slp=0;
            document.onkeydown=(e)=>{
                if(ck==1){
                    if(e.key=='g'){
                        test(0);
                    }
                    else if(e.key=='h'){
                        test(1);
                    }
                    else if(e.key=='j'){
                        test(2);
                    }
                }
            };
            function test(bt){
                bk();
                draw();
                if(peo[0]==1&&bt==0){
                    peo.splice(0, 1);
                    peo.push(peo2[Math.floor(Math.random()*3)]);
                    ttl1++;
                }
                else if(peo[0]==3&&bt==1){
                    peo.splice(0, 1);
                    peo.push(peo2[Math.floor(Math.random()*3)]);
                    ttl1++;
                }
                else if(peo[0]==5&&bt==2){
                    peo.splice(0, 1);
                    peo.push(peo2[Math.floor(Math.random()*3)]);
                    ttl1++;
                }
                else err();
                shtm();
            }
            function err(){
                ck=0;
                let a=peo[0];
                delete peo[0];
                bk();
                draw();
                shtm();
                slp=100;
                for(let i=0;i<=((ttl1/50)+1)*25;i++) dw(i,a);
                for(let i=((ttl1/50)+1)*25;i>=0;i--) dw(i,a);
                window.setTimeout(function() {
                    peo[0]=a;
                    bk();
                    draw();
                    shtm();
                }, slp+1);
                setTimeout(() => ck=1, slp+50)
            }
            function per(){
                peo=[];
                for(let i=0;i<sht;i++){
                    peo.push(`${peo2[Math.floor(Math.random()*3)]}`);
                }
            }
            function shtm(){
                for(let i=0;i<sht;i++){
                    ctx.beginPath();
                    ctx.arc(((cvs.width-4*br)/6+br/2)*peo[i]+br/2,((cvs.height*0.65-sht*br1)/sht+br1)*(sht-i)-cvs.height*0.04+cvs.height*0.08,cvs.height*0.6/sht/2,0,Math.PI*2);
                    ctx.fillStyle="#c85656";
                    ctx.fill();
                    ctx.closePath()
                }
            }
            function bk(){
                ctx.clearRect(0,0,cvs.width,cvs.height);
                ctx.save();
                ctx.fillStyle="#181818";
                ctx.fillRect(0,0,cvs.width,cvs.height);
                ctx.restore();
            }
            function draw(){
                ctx.fillStyle="black";
                ctx.fillRect(0,0,cvs.width,cvs.height*0.1);
                ctx.closePath();
                ctx.closePath();
                //------------------------------------------------------
                let gdt=ctx.createLinearGradient(0,0,cvs.width,cvs.height);
                gdt.addColorStop(1,"#f00");
                gdt.addColorStop(0,"#f0f");
                ctx.strokeStyle=gdt;
                ctx.lineWidth=10;
                ctx.beginPath();
                ctx.moveTo(0,0);
                ctx.lineTo(0,cvs.height);
                ctx.lineTo(cvs.width,cvs.height);
                ctx.lineTo(cvs.width,0);
                ctx.lineTo(0,0);
                ctx.stroke();
                ctx.closePath();
                //------------------------------------------------------------
                ctx.beginPath();
                for(let i=1;i<=5;i+=2){   
                    ctx.arc(((cvs.width-4*br)/6+br/2)*i+br/2,cvs.height*0.85,cvs.height*0.1,0,Math.PI*2);
                    ctx.fillStyle="black";
                    ctx.fill();
                }
                for(let i=1;i<=5;i+=2){
                    ctx.font = "175px arial";
                    ctx.textAlign = "center";
                    ctx.fillStyle = "red";
                    ctx.fillText("Shoot!",((cvs.width-4*br)/6+br/2)*i+br/2,cvs.height*0.87);
                }
            }
            function dw(i,a){
                window.setTimeout(function() {
                    bk();
                    draw();
                    shtm();
                    ctx.beginPath();
                    ctx.arc(((cvs.width-4*br)/6+br/2)*a+br/2,((cvs.height*0.65-sht*br1)/sht+br1)*(sht-0)-cvs.height*0.04+cvs.height*0.08-i*cvs.height*0.0018,cvs.height*0.6/sht/2,0,Math.PI*2);
                    ctx.fillStyle="#c85656";
                    ctx.fill();
                    ctx.arc(((cvs.width-4*br)/6+br/2)*a+br/2,((cvs.height*0.65-sht*br1)/sht+br1)*(sht-0)-cvs.height*0.04+cvs.height*0.08-i*cvs.height*0.0018,cvs.height*0.6/sht/2,0,Math.PI*2);
                    ctx.strokeStyle="black";
                    ctx.stroke()
                    ctx.closePath()
                }, slp);
            }
            bk();
            draw();
            per();
            shtm();
        </script>
    </body>
</html>
